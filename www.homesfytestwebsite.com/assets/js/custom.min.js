async function saveLead(e,t,n,o,a,i){if("+91"===n){let e=o.replace(/\D/g,"");if(10!==e.length||/^[1-5]/.test(e))return alert("Invalid phone number. For Indian numbers, enter a valid 10-digit number starting with 6-9."),!1}let r=document.querySelector(".dropnOtp");if(r&&""===r.value&&parseInt(o))try{let e=await fetch("https://api.homesfy.in/api/users/send_otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:parseInt(o)})});if(e.ok){let t=await e.json();r.value=t.otp}}catch(e){console.error("Error sending OTP:",e)}let l=[".FillOtp",".FillOtp1",".FillOtp2"].map(e=>document.querySelector(e)).filter(e=>e);if(!r||""!==r.value&&l.some(e=>r.value===e.value)){const r="+91"===n?1:2;let l=queryForm(),u=await getIpAddress(),d=deviceData(),m=browserData(),s={name:e,email:t,country_code:n,number:o,tracking_lead_id:a,nationality:r,source_id:31,project_id:projectId,Digital:{user_device:d,user_browser:m,campaing_type:l?l.utmcampaign:null,launch_name:"",client_ipaddress:u,client_pref:i}};l&&(s.Utm={utm_medium:l.utmmedium,utm_source:l.utmsource,utm_content:l.utmcontent,utm_term:l.utmterm}),1===is_magnet&&(s.is_magnet=is_magnet,s.magnet_id=magnet_id,s.source_id=49),localStorage.setItem("submittedCountryCode",n),localStorage.setItem("submittedPhone",o),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"formSubmitted",phone_number:`${n}${o}`}),SendLead(s,"thankyou.html")}else if(r&&""!==r.value)return alert("Invalid OTP"),!1}function setupToggleButton(e,t,n){let o=document.getElementById(e);o&&o.addEventListener("click",function(){toggleVisibility(t,"block"),toggleVisibility(n,"none")})}function toggleVisibility(e,t){document.querySelectorAll(`.${e}`).forEach(e=>{e.style.display=t})}document.addEventListener("DOMContentLoaded",function(){apiDataGet(projectId),["ModalFormSlug1","ModalFormSlug2","ModalFormSlug3","ModalFormSlug4"].forEach(e=>{let t=document.getElementById(e);t&&t.addEventListener("submit",function(e){e.preventDefault(),saveLead(t.querySelector(".form-name").value,null,t.querySelector(".form-country").value,t.querySelector(".form-number").value,t.dataset.trackingId||"default_tracking_id")})}),setupToggleButton("dropbtn","showdrop","hidedrop"),setupToggleButton("mbutton","mfieldshow","mfieldhide"),setupToggleButton("popbutton","popfieldshow","popfieldhide")});